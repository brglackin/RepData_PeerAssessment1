# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
We first change the working directory to the repository location and load our datafile.

```{r echo = TRUE}
setwd("~/GitHub/RepData_PeerAssessment1")
data<-read.csv("data/activity.csv")
```

## What is mean total number of steps taken per day?
We can aggregate the data by date, getting the sum of the steps per day. For this, we ignore any blank/missing entries.

```{r echo = TRUE}
totalStepsByDate<-aggregate(steps ~ date, data, sum,na.rm=T)
```
A histogram can be created from this by using the hist command as follows:

```{r echo = TRUE}
hist(totalStepsByDate$steps, xlab = "Average Daily Steps Taken", ylab="Frequency", 
     main="Frequency of the Average Daily Steps Taken")
```

In order to get the mean and median of this data, we can simply call the mean and median functions on the steps variable, respectively.

```{r echo = TRUE}
dataMean<-mean(totalStepsByDate$steps, na.rm=T)
dataMedian<-median(totalStepsByDate$steps, na.rm=T)
dataMean;dataMedian
```
The mean number of steps per day is <b>`r format(dataMean,scientific = FALSE)`</b> and the median number of steps per day is <b>`r dataMedian`</b>.

## What is the average daily activity pattern?
We can aggregate the steps counts by interval over all days and plot the results:

```{r echo = TRUE}
meanStepsByInterval<-aggregate(steps ~ interval, data, mean,na.rm=T)
plot(meanStepsByInterval$interval,meanStepsByInterval$steps, xlab="Interval Number",ylab = "Average Steps", main="Average Steps per Interval for all Days")
```

To find the interval withe the largest average steps count, we use the which.max function:

```{r echo = TRUE}
largestMean<-meanStepsByInterval[which.max( meanStepsByInterval[,2] ),]
largestMean
```

The largest average number of steps is <b>`r format(largestMean$steps,scientific=FALSE)`</b> which occurs in interval <b>`r largestMean$interval`</b>.

## Imputing missing values
We first compute the number of rows with missing values:

```{r echo = TRUE}
nrow(data) - sum(complete.cases(data))
```

For each missing value, we use the average for that interval instead, applying this to a copy of the original dataset.

```{r echo=TRUE}
dataNoNAs <- data
for (i in 1:nrow(dataNoNAs))
{
  if(is.na(dataNoNAs[i,1]))
  {
    dataNoNAs[i,1]<-meanStepsByInterval[meanStepsByInterval$interval == dataNoNAs[i,3],2]
  }
}
```
We confirm that we no longer have any missing values:
```{r echo = TRUE}
nrow(dataNoNAs[is.na(dataNoNAs$steps),])
```

We aggregate the average steps counts by date and plot a histogram. 
```{r echo = TRUE}
totalStepsByDateNoNAs<-aggregate(steps ~ date, dataNoNAs, sum,na.rm=T)
hist(totalStepsByDateNoNAs$steps,xlab = "Average Daily Steps Taken", ylab="Frequency", 
     main="Frequency of the Average Daily Steps Taken")
```

We calculate the mean and median of this modified data as before.
```{r echo = TRUE}
mean(totalStepsByDateNoNAs$steps, na.rm=T)
median(totalStepsByDateNoNAs$steps, na.rm=T)
```

## Are there differences in activity patterns between weekdays and weekends?
We assign a factor variable to each record indicating whether the record represents a week day or weekend day, and create a new dataframe with the extra column added to the original dataset.
```{r echo = TRUE}
weekendDays <-c("Saturday", "Sunday")
dayType <-apply(dataNoNAs,1,function(row) 
  {
    ifelse(weekdays(as.Date(row[2],"%Y-%m-%d")) %in% weekendDays, "weekend","weekday")
   })
dataNoNAs<-data.frame(dataNoNAs,dayType=as.factor(dayType))
```

We aggregate the data by interval and dayType, and plot the graph with the lattice package's xyplot command.

```{r echo =TRUE}
library(lattice)

aggregatedData <- aggregate(steps ~ interval+dayType, dataNoNAs, mean)
xyplot(steps~interval|dayType, aggregatedData,
   type = "l",
   main="Steps per Interval", 
   ylab="Number of Steps", xlab="Interval",
   layout=c(1,2))

```
